<!DOCTYPE html>
<html lang="zh-CN">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>å¤§å¤çš„è‡ªç•™åœ°</title>
  <style>
    * {
      box-sizing: border-box;
      margin: 0;
      padding: 0;
    }

    body {
      font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
      background: #0f172a;
      color: #e5e7eb;
      line-height: 1.6;
    }

    .layout {
      max-width: 960px;
      margin: 0 auto;
      padding: 24px 16px 80px;
    }

    header {
      padding: 16px 0 24px;
      border-bottom: 1px solid rgba(148, 163, 184, 0.3);
      margin-bottom: 24px;
      display: flex;
      justify-content: space-between;
      align-items: center;
    }

    header h1 {
      font-size: 24px;
      color: #f9fafb;
    }

    header p {
      font-size: 14px;
      color: #9ca3af;
    }

    .tag {
      display: inline-block;
      padding: 4px 10px;
      border-radius: 999px;
      font-size: 12px;
      background: rgba(56, 189, 248, 0.15);
      color: #38bdf8;
      text-decoration: none;
    }

    .tag:hover {
      text-decoration: underline;
      box-shadow: 0 0 8px rgba(56, 189, 248, 0.4);
    }

    main {
      display: grid;
      grid-template-columns: minmax(0, 2fr) minmax(280px, 1fr);
      gap: 24px;
    }

    @media (max-width: 768px) {
      main {
        grid-template-columns: 1fr;
      }
    }

    .card {
      background: rgba(15, 23, 42, 0.9);
      border-radius: 14px;
      padding: 16px 18px;
      border: 1px solid rgba(148, 163, 184, 0.25);
      box-shadow: 0 18px 45px rgba(15, 23, 42, 0.8);
      margin-bottom: 16px;
    }

    .card h2 {
      font-size: 18px;
      margin-bottom: 8px;
      color: #f9fafb;
    }

    .card small {
      font-size: 12px;
      color: #9ca3af;
    }

    .post-list {
      list-style: none;
      margin-top: 8px;
    }

    .post-list li {
      padding: 10px 0;
      border-bottom: 1px dashed rgba(51, 65, 85, 0.7);
      cursor: pointer;
    }

    .post-list li:last-child {
      border-bottom: none;
    }

    .post-list li:hover {
      background: rgba(30, 41, 59, 0.5);
      transition: background 0.2s;
    }

    .post-title {
      font-size: 15px;
      color: #e5e7eb;
      font-weight: 500;
    }

    .post-meta {
      font-size: 12px;
      color: #9ca3af;
    }

    .post-tags span {
      display: inline-block;
      margin-top: 4px;
      margin-right: 6px;
      padding: 2px 8px;
      border-radius: 999px;
      font-size: 11px;
      background: rgba(55, 65, 81, 0.9);
      color: #e5e7eb;
    }

    .about p {
      font-size: 14px;
      color: #dbeafe;
      margin-bottom: 6px;
    }

    .links a {
      display: inline-block;
      margin-right: 8px;
      margin-top: 6px;
      font-size: 13px;
      color: #38bdf8;
      text-decoration: none;
    }

    .links a:hover {
      text-decoration: underline;
    }

    footer {
      margin-top: 40px;
      text-align: center;
      font-size: 12px;
      color: #6b7280;
    }
  </style>
</head>

<body>
  <div class="layout">
    <header>
      <div>
        <h1>å¤§å¤çš„è‡ªç•™åœ°</h1>
        <p>è®°å½•ä¸€ç‚¹ç”Ÿæ´»ã€æŠ€æœ¯ï¼Œè¿˜æœ‰ä¹±ä¸ƒå…«ç³Ÿçš„æƒ³æ³•ã€‚</p>
      </div>
      <div>
        <span class="tag">ä¸ªäººåšå®¢ Â· shidagu.online</span>
        <a href="/admin.html" class="tag" style="margin-left:8px;">å†™æ–‡ç« </a>
        <a href="/todos.html" class="tag" style="margin-left:8px;">Todo å°å·¥å…·</a>
      </div>
    </header>

    <main>
      <!-- å·¦ä¾§ï¼šæ–‡ç« åˆ—è¡¨ -->
      <section>
        <div class="card">
          <h2>æœ€æ–°æ–‡ç« </h2>
          <small>ä¸‹é¢æ˜¯ä»æ•°æ®åº“é‡Œè¯»å‡ºæ¥çš„æ–‡ç« åˆ—è¡¨ ğŸ‘‡</small>
          <ul class="post-list" id="post-list"></ul>
        </div>
      </section>

      <!-- å³ä¾§ï¼šå…³äºæˆ‘ / å°èµ„æ–™ -->
      <aside>
        <div class="card about">
          <h2>å…³äºæˆ‘</h2>
          <p>ğŸ§‘â€ğŸ’» ä¸€ä¸ªæ­£åœ¨å­¦ä¹ ç¼–ç¨‹çš„äººã€‚</p>
          <p>ğŸ¯ ç›®æ ‡ï¼šèƒ½ç‹¬ç«‹å®Œæˆè‡ªå·±æƒ³åšçš„ç½‘ç«™ / å°å·¥å…·ã€‚</p>
          <p>ğŸ“ è¿™é‡Œæ˜¯æˆ‘çš„å°è§’è½ï¼Œç”¨æ¥è¯•éªŒå„ç§æƒ³æ³•ã€‚</p>
        </div>

        <div class="card">
          <h2>å°å¡ç‰‡ / çŠ¶æ€</h2>
          <p class="post-meta">ç°åœ¨åœ¨å­¦ï¼š</p>
          <p>Â· Node.js åç«¯ Â· MongoDB æ•°æ®åº“ Â· å‰ç«¯åŸºç¡€</p>
          <p class="post-meta" style="margin-top:8px;">æƒ³åšçš„ä¸€äº›ä¸œè¥¿ï¼š</p>
          <p>Â· åƒ QQ ç©ºé—´ä¸€æ ·çš„ä¸ªäººç©ºé—´<br>Â· è®°å½•å­¦ä¹ è½¨è¿¹çš„æ—¶é—´çº¿<br>Â· ä»¥åä¹Ÿè®¸è¿˜æœ‰è¯„è®ºåŒº</p>
        </div>

        <div class="card links">
          <h2>è”ç³»</h2>
          <a href="mailto:shidaguya@proton.me">ğŸ“® é‚®ç®±</a>
        </div>
      </aside>
    </main>

    <footer>
      Â© <span id="year"></span> shidagu.online Â· å¤§å¤çš„è‡ªç•™åœ°
    </footer>
  </div>

  <script>
    // åº•éƒ¨å¹´ä»½
    document.getElementById('year').textContent = new Date().getFullYear();

    const API_BASE = 'https://todo-backend-alpha-henna.vercel.app/api';



    async function loadPosts() {
      const listEl = document.getElementById('post-list');
      listEl.innerText = 'åŠ è½½ä¸­â€¦';

      try {
        const res = await fetch(`${API_BASE}/posts`);
        const data = await res.json();

        if (!Array.isArray(data)) {
          listEl.innerText = 'æ•°æ®æ ¼å¼ä¸å¯¹';
          console.warn('è¿”å›çš„æ•°æ®ä¸æ˜¯æ•°ç»„ï¼š', data);
          return;
        }

        if (data.length === 0) {
          listEl.innerText = 'è¿˜æ²¡æœ‰æ–‡ç« ï¼Œå…ˆåœ¨ /admin.html é‡Œå‘ä¸€ç¯‡è¯•è¯•å§ï½';
          return;
        }

        // æŒ‰æ—¶é—´æ’åºï¼ˆä¿é™©ä¸€ç‚¹ï¼‰
        data.sort((a, b) => new Date(b.createdAt) - new Date(a.createdAt));

        listEl.innerHTML = '';

        data.forEach(post => {
          const li = document.createElement('li');

          const link = document.createElement('a');
          link.href = `/post.html?id=${post._id}`;
          link.style.textDecoration = 'none';
          link.style.color = 'inherit';

          const titleDiv = document.createElement('div');
          titleDiv.className = 'post-title';
          const titleText = post.title || 'æ— æ ‡é¢˜';
          titleDiv.textContent = titleText.length > 40
            ? titleText.slice(0, 40) + 'â€¦'
            : titleText;

          const metaDiv = document.createElement('div');
          metaDiv.className = 'post-meta';
          if (post.createdAt && !isNaN(Date.parse(post.createdAt))) {
            const d = new Date(post.createdAt);
            metaDiv.textContent = d.toLocaleDateString('zh-CN', {
              year: 'numeric',
              month: '2-digit',
              day: '2-digit',
              hour: '2-digit',
              minute: '2-digit'
            });
          } else {
            metaDiv.textContent = '';
          }

          const tagsDiv = document.createElement('div');
          tagsDiv.className = 'post-tags';
          if (Array.isArray(post.tags) && post.tags.length > 0) {
            post.tags.forEach(t => {
              const span = document.createElement('span');
              span.textContent = t;
              tagsDiv.appendChild(span);
            });
          } else {
            const span = document.createElement('span');
            span.textContent = 'æ–‡ç« ';
            tagsDiv.appendChild(span);
          }

          link.appendChild(titleDiv);
          link.appendChild(metaDiv);
          link.appendChild(tagsDiv);

          li.appendChild(link);
          listEl.appendChild(li);
        });

      } catch (err) {
        console.error(err);
        listEl.innerText = 'åŠ è½½å¤±è´¥ï¼ˆæ‰“å¼€ F12 æ§åˆ¶å°çœ‹çœ‹é”™è¯¯ä¿¡æ¯ï¼‰';
      }
    }

    loadPosts();
  </script>
</body>

</html>